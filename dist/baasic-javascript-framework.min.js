!function(e,n,t,i){function a(e,n){for(var t in n)e[t]=n[t];return e}var r=e.MonoSoftware||(e.MonoSoftware={}),u=t!==i?function(e,n,i){t(n).on(e,i)}:function(e,n,t){n.addEventListener?n.addEventListener(e,t,!1):n.attachEvent?n.attachEvent("on"+e,t):n["on"+e]=t},o=t!==i?function(e,n,i){var r=a(t.Event(n),i);t(e).trigger(r)}:function(e,t,i){var r;return CustomEvent&&"function"==typeof CustomEvent?(r=a(new CustomEvent(t)),void e.dispatchEvent(r)):n.createEvent?(r=n.createEvent("CustomEvent"),r.initEvent(t,!0,!0),i&&a(r,i),void(e.dispatchEvent?e.dispatchEvent(r):n.dispatchEvent(r))):(r=n.createEventObject(),r.eventType=t,i&&a(r,i),void e.fireEvent("on"+r.eventType,r))};!function(t){!function(t){function r(e,n){return new l(e,n)}function s(e){o(n,"userChange",{user:e})}function c(){o(n,"tokenExpired")}function l(n,t){function r(){return n}function o(){return w}function l(){return S.token}function v(e){p(S.user,e)}function f(){return S}function p(e,n){clearTimeout(_),n===i||null==n||e===i||null==e?(localStorage.removeItem(k),m(null,null)):(m(e,n),localStorage.setItem(k,JSON.stringify(S)),_=h(S.token))}function h(e){if(e&&null!=e&&e.expireTime){var n=e.expireTime-(new Date).getTime();if(n>0)return setTimeout(c,n)}return null}function m(e,n){var t={isAuthenticated:function(){return this.token!==i&&null!==this.token&&(this.token.expireTime===i||null===this.token.expireTime||this.token.expireTime-(new Date).getTime()>0)}};e&&(t.user=e),n&&(n.expireTime||(n.expires_in?n.expireTime=(new Date).getTime()+1e3*n.expires_in:n.sliding_window&&(n.expireTime=(new Date).getTime()+1e3*n.sliding_window)),t.token=n),S=t}function d(){return T.language?T.language:g?g:E()}function E(){return T.defaultLanguage}var T={useSSL:!1,defaultLanguage:"en",apiRootUrl:"api.baasic.com",apiVersion:"v1"};a(T,t);var w=T.useSSL?"https":"http://"+T.apiRootUrl+"/"+T.apiVersion+"/"+n+"/",k="baasic-user-info-"+n,S=JSON.parse(localStorage.getItem(k)),_=null;null!=S?(_=h(S.token),m(S.user,S.token)):m(null,null),u("storage",e,function(e){switch(e=e||event,e.originalEvent&&(e=e.originalEvent),e.key){case k:var n=e.newValue;if(n===i||null==n||""==n)m(null,null);else{var t=JSON.parse(n);m(t.user,t.token)}s(S)}}),this.get_apiKey=r,this.get_apiUrl=o,this.get_accessToken=l,this.update_accessToken=v,this.get_user=f,this.set_user=p,this.get_currentLanguage=d,this.get_defaultLanguage=E}var g=navigator.language||navigator.userLanguage;t.init=r}(t.Application||(t.Application={}))}(r.Baasic||(r.Baasic={}))}(window,document,jQuery);